<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="icon" href="/image/logo.png"><title>性能测试参数理解 | 一条奇怪鱼</title><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="系统吞吐量指的是系统在单位时间内可处理的事务的数量，是用于衡量系统性能的重要指标 系统吞吐量有几个重要指标参数： QPS TPS 响应时间 并发数  QPS(Queries Per Second) 是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准,  即每秒的响应请求数 TPS(Transactions Per Second) 是每秒钟系统能够处理的"><meta property="og:type" content="article"><meta property="og:title" content="性能测试参数理解"><meta property="og:url" content="https://blog.qiguaiyu.com/209c2dc1.html"><meta property="og:site_name" content="一条奇怪鱼"><meta property="og:description" content="系统吞吐量指的是系统在单位时间内可处理的事务的数量，是用于衡量系统性能的重要指标 系统吞吐量有几个重要指标参数： QPS TPS 响应时间 并发数  QPS(Queries Per Second) 是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准,  即每秒的响应请求数 TPS(Transactions Per Second) 是每秒钟系统能够处理的"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-01-05T14:00:00.000Z"><meta property="article:modified_time" content="2023-01-08T12:25:46.334Z"><meta property="article:author" content="Duibing"><meta property="article:tag" content="一条奇怪鱼"><meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/image/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"> <a href="/" id="logo">一条奇怪鱼</a></h1></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">主页</a> <a class="main-nav-link" href="/archives">归档</a></nav></div></div></header><div class="outer"><section id="main"><article id="post-性能测试参数理解" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="article-meta"> <a href="/209c2dc1.html" class="article-date"><time class="dt-published" datetime="2023-01-05T14:00:00.000Z" itemprop="datePublished">2023-01-05</time></a></div><div class="article-inner"><header class="article-header"><h1 class="p-name article-title" itemprop="headline name"> 性能测试参数理解</h1></header><div class="article-entry" itemprop="articleBody"><p>系统吞吐量指的是系统在单位时间内可处理的事务的数量，是用于衡量系统性能的重要指标</p><h1 id="系统吞吐量有几个重要指标参数："><a href="#系统吞吐量有几个重要指标参数：" class="headerlink" title="系统吞吐量有几个重要指标参数："></a>系统吞吐量有几个重要指标参数：</h1><ul><li>QPS</li><li>TPS</li><li>响应时间</li><li>并发数</li></ul><h1 id="QPS"><a href="#QPS" class="headerlink" title="QPS"></a>QPS</h1><p>(Queries Per Second)</p><p>是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准, 即每秒的响应请求数</p><h1 id="TPS"><a href="#TPS" class="headerlink" title="TPS"></a>TPS</h1><p>(Transactions Per Second)</p><p>是每秒钟系统能够处理的交易或事务的数量，它是衡量系统处理能力的重要指标</p><p>具体事务的定义都是人为的，可以一个接口、多个接口、一个业务流程等等</p><h1 id="RT"><a href="#RT" class="headerlink" title="RT"></a>RT</h1><p>(Response-time) 响应时间</p><p>执行一个请求从开始到最后收到响应数据所花费的总体时间，即从客户端发起请求到收到服务器响应结果的时间</p><p>该请求可以是任何东西，从内存获取，磁盘IO，复杂的数据库查询或加载完整的网页</p><h1 id="Concurrency"><a href="#Concurrency" class="headerlink" title="Concurrency"></a>Concurrency</h1><p>并发数是指系统同时能处理的请求数量，这个也反应了系统的负载能力</p><p>并发，指的是多个事情，在同一段时间段内发生了，大家都在争夺统一资源</p><h1 id="QPS与TPS的区别"><a href="#QPS与TPS的区别" class="headerlink" title="QPS与TPS的区别"></a>QPS与TPS的区别</h1><p>假如对于一个页面的一次访问算一个TPS，但一次页面请求，可能产生N次对服务器的请求，服务器对这些请求，就可计入QPS之中，即QPS&#x3D;N*TPS</p><p>又假如对一个查询接口（单场景）压测，且这个接口内部不会再去请求其它接口，那么TPS&#x3D;QPS</p><h1 id="JMeter的吞吐量计算方式"><a href="#JMeter的吞吐量计算方式" class="headerlink" title="JMeter的吞吐量计算方式"></a>JMeter的吞吐量计算方式</h1><p>文档将吞吐量定义为</p><p>请求数 &#x2F; 时间单位。从第一个样本开始到最后一个样本结束，计算时间。这包括样本之间的任何间隔，因为它被认为代表了服务器上的负载。</p><p>公式是:吞吐量 &#x3D; (请求数量) &#x2F; (总时间)</p><p>例：您有1个请求，耗时1129ms，所以</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Throughput = 1 / 1129ms = 0.00088573959/ms</span><br><span class="line">           = 0.00088573959 * 1000/sec = 0.88573959/sec</span><br><span class="line">           = 0.88573959 * 60/min = 53.1443754/min, rounded to 53.1/min</span><br></pre></td></tr></table></figure><h1 id="PV"><a href="#PV" class="headerlink" title="PV"></a>PV</h1><p>(Page View)</p><p>页面访问量，即页面浏览量或点击量，用户每次刷新即被计算一次</p><h1 id="UV"><a href="#UV" class="headerlink" title="UV"></a>UV</h1><p>(Unique Visitor)</p><p>独立访客，统计1天内访问某站点的用户数</p><h1 id="DAU"><a href="#DAU" class="headerlink" title="DAU"></a>DAU</h1><p>(Daily Active Use)</p><p>日活跃用户数量。常用于反映网站、互联网应用或网络游戏的运营情况</p><h1 id="MAU"><a href="#MAU" class="headerlink" title="MAU"></a>MAU</h1><p>(Month Active User)</p><p>月活跃用户数量，指网站、app等去重后的月活跃用户数量</p><h1 id="实际举例"><a href="#实际举例" class="headerlink" title="实际举例"></a>实际举例</h1><p>按二八定律来看，如果每天 80% 的访问集中在 20% 的时间里，这 20% 时间就叫做峰值时间</p><p>公式：( 总PV数 <em>80% ) &#x2F; ( 每天秒数</em> 20% ) &#x3D; 峰值时间每秒请求数(QPS)</p><p>机器：峰值时间每秒QPS &#x2F; 单台机器的QPS &#x3D; 需要的机器</p><p>1、每天300w PV 的在单台机器上，这台机器需要多少QPS？<br>( 3000000 <em>0.8 ) &#x2F; (86400</em> 0.2 ) &#x3D; 139 (QPS)</p><p>2、如果一台机器的QPS是58，需要几台机器来支持？<br>139 &#x2F; 58 &#x3D; 3</p><h1 id="正确配置线程池参数"><a href="#正确配置线程池参数" class="headerlink" title="正确配置线程池参数"></a>正确配置线程池参数</h1><h2 id="一个简单并且适用面比较广的公式："><a href="#一个简单并且适用面比较广的公式：" class="headerlink" title="一个简单并且适用面比较广的公式："></a>一个简单并且适用面比较广的公式：</h2><ul><li><strong>CPU 密集型任务(N+1)：</strong> 这种任务消耗的主要是 CPU 资源，可以将线程数设置为 N（CPU 核心数）+1。比 CPU 核心数多出来的一个线程是为了防止线程偶发的缺页中断，或者其它原因导致的任务暂停而带来的影响。一旦任务暂停，CPU 就会处于空闲状态，而在这种情况下多出来的一个线程就可以充分利用 CPU 的空闲时间</li><li><strong>I&#x2F;O 密集型任务(2N)：</strong> 这种任务应用起来，系统会用大部分的时间来处理 I&#x2F;O 交互，而线程在处理 I&#x2F;O 的时间段内不会占用 CPU 来处理，这时就可以将 CPU 交出给其它线程使用。因此在 I&#x2F;O 密集型任务的应用中，我们可以多配置一些线程，具体的计算方法是 2N</li></ul><blockquote><p>线程数更严谨的计算的方法应该是：<code>最佳线程数 = N（CPU 核心数）∗（1+WT（线程等待时间）/ST（线程计算时间））</code>，其中 <code>WT（线程等待时间）=线程运行总时间 - ST（线程计算时间）</code></p><p>线程等待时间所占比例越高，需要越多线程。线程计算时间所占比例越高，需要越少线程</p><p>我们可以通过 JDK 自带的工具 VisualVM 来查看 <code>WT/ST</code> 比例</p><p>CPU 密集型任务的 <code>WT/ST</code> 接近或者等于 0，因此， 线程数可以设置为 N（CPU 核心数）∗（1+0）&#x3D; N，和我们上面说的 N（CPU 核心数）+1 差不多</p><p>IO 密集型任务下，几乎全是线程等待时间，从理论上来说，你就可以将线程数设置为 2N（按道理来说，WT&#x2F;ST 的结果应该比较大，这里选择 2N 的原因应该是为了避免创建过多线程吧）</p></blockquote><h2 id="如何判断是-CPU-密集任务还是-IO-密集任务？"><a href="#如何判断是-CPU-密集任务还是-IO-密集任务？" class="headerlink" title="如何判断是 CPU 密集任务还是 IO 密集任务？"></a>如何判断是 CPU 密集任务还是 IO 密集任务？</h2><p>CPU 密集型简单理解就是利用 CPU 计算能力的任务比如你在内存中对大量数据进行排序。但凡涉及到网络读取，文件读取这类都是 IO 密集型，这类任务的特点是 CPU 计算耗费时间相比于等待 IO 操作完成的时间来说很少，大部分时间都花在了等待 IO 操作完成上</p></div><footer class="article-footer"></footer></div><nav id="article-nav"> <a href="/a6d8cedb.html" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">前一篇</strong><div class="article-nav-title"> Java秒杀设计</div></a> <a href="/b543ced0.html" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">后一篇</strong><div class="article-nav-title">RabbitMQ</div></a></nav></article></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">归档</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">最新文章</h3><div class="widget"><ul><li> <a href="/46e35c1e.html">JMeter</a></li><li> <a href="/228d20a7.html">Hikari连接池</a></li><li> <a href="/bae4ff13.html">Redis</a></li><li> <a href="/a6d8cedb.html">Java秒杀设计</a></li><li> <a href="/209c2dc1.html">性能测试参数理解</a></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner"> &copy; 2023 Duibing<br> Powered by <a href="https://qiguaiyu.com/" target="_blank">qiguaiyu.com</a></div></div></footer></div><nav id="mobile-nav"> <a href="/" class="mobile-nav-link">主页</a> <a href="/archives" class="mobile-nav-link">归档</a></nav><script src="/js/jquery-3.4.1.min.js"></script><script src="/fancybox/jquery.fancybox.min.js"></script><script src="/js/script.js"></script></div></body></html>